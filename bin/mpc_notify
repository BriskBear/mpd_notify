#!/usr/bin/bash

# Creedence Clearwater Revival - Ramble Tamble
# [playing] #289/1832   3:21/7:13 (46%)
# volume:100%   repeat: off   random: on    single: off   consume: off

output=`mpc`
artist=`echo $output|awk -F'-' '{print $1}'`
elapsed=`echo $output|awk -F'[\),\(]' '{print $2}'|awk -F'%' '{print $1}'` 2>/dev/null
state=`echo $output|awk -F'[\],\[]' '{print $2}'`   2>/dev/null
title=`echo $output|awk -F'[-,\[]' '{print $2}'`    2>/dev/null
time=`echo $output|awk -F'#' '{print $2}'|awk '{print $2}'`
ffmpeg -y -i "$HOME/data/`mpc --format %file%|head -1`" -filter:v scale=-2:120 /tmp/cover.jpg

dunstify -i /tmp/cover.jpg -r 27 -h int:id:27 -h int:value:$elapsed "${state^}: " "Title: ${title}\nArtist: ${artist}\n${time}"
